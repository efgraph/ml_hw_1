### ДЗ 1 
__ФИО:__ _Спиридонов Д В (специальность МОВС)_

### Разведочный анализ данных (EDA)

### Модель только на вещественных признаках
* Для удобства вместо MSE использовал RMSE, т.к. целевой признак price имеет очень высокую размерность
* Результаты экспериментов

|Model| R^2 | RMSE|
| --- |---| --- |
| LinearRegression | 0.59 | 482700.63 |
| LinearRegression (Scaled) | 0.59 | 482700.63 |
| Lasso | 0.59 | 482701.34 |
| Lasso (Cross-validation) | 0.57 | 497948.03 |
| ElasticNet (Cross-validation) | 0.57 | 497948.03|

Без кросс валидации метрики немного лучше, но это скорее значит что модели переобучены

### Добавляем категориальные фичи

* Благодаря добавлению категориальных фич удалось улучшить качество предсказаний

| Model  | R^2 | RMSE |
|--------|---|---|
| Ridge (Cross-validation) | 0.64 | 451846.19 |

### Feature Engineering
* Чтобы была впоследствии валидная бизнес метрика удалил полные дубликаты из тестового датасета.
* Не удалял признак name, оставил в виде названия брэнда, закодировав при помощи LeaveOneOutEncoder, т.к. уникальных значений в этом столбце оказалось 30
* Добавил фичи:
  - возраст авто age
  - пробег за год km_per_year
  - максимальная мощность на литр двигателя max_power_per_liter
  - бинарный признак fresh_owner (1 если авто принадлежит 1-му или 2-му владельцу)
* К манипуляциям с данными, описанными выше добавил логарифмирование целевого признака price, это дало существенное улучшение метрик

| Model                    | R^2 | RMSE |
|---|---|------|
| Ridge (Cross-validation) | 0.87 | 0.29 |


### Выводы о проделанной работе

* Была обучена модель регрессии для предсказания стоимости автомобилей и реализован веб-сервис с полученной моделью
* Метрика R_2=0.87. От реальных цен не более чем на 10% отличается 30.17% предсказаний.
* Наибольший буст в качестве дало логарифмирование целевой переменной
* Не вышло избавиться от выбросов, это вело модель к переобучению

### Реализация сервиса на FastAPI

##### Документация

http://localhost/api/openapi  
или  
http://localhost/redoc

В папке assets примеры данных для каждого из ендпоитов

### Запуск проекта 

Из корневой директории выполнить docker-compose up -d

**Удаление проекта**

1. docker-compose down
2. docker image prune --all

## Скриншоты работы сервиса

![endpoints](./screenshots/openapi.png?raw=true)
![predict_item](./screenshots/predict_item.png?raw=true)
![predict_items](./screenshots/predict_items.png?raw=true)